# `.deckdef` 文件定义速览
本文简要的说明如何使用 `.deckdef` 来进行卡组类别定义。
## 定义文件结构
   `.deckdef` 文件使用**缩进**来区分层级结构。
   
   多个定义在同一个文件中时，直接并列放置即可。
   
   缩进不论何时都认为 `Tab` 空格数为 `2`。对于多数编写者而言，您无需关心这个数字。
  
   `#` 为注释提示符。不论处于何种语境下的 `#` 后面的字符将被忽略。如果需要使用 `#` 字符进行相关编写，请使用 `\#` 代替。
## 怎样定义一个约束条件
约束条件是指一个对于卡组的条件。

用 `card:` 来指定某个卡的数量条件：

    card: 六武之门 main >= 1

用 `set:` 来指定某个系列的卡的数量条件：

    set: 暗黑界 >= 10
    
判断在何处判定（诸如 `main`）这一选项是可选的。如果不指定的话，会判断整个卡组中的总数（`all`）。这一位置可以填下列内容：
    
+ `main`
+ `side`
+ `ex`
+ `all`

判断条件中，`=` 和 `==`是等价的。

简略的写，可以直接用 `restrain` 或者 `!` 来代替 `card` 和 `set`，如：
    
        restrain: [天帝] == 1  # 定义含某个名字的卡的数量
        ! 十二兽 鼠 main >= 2  # 定义某张卡的数量
        ! [真龙] >= 10        # 定义某个系列卡的数量
    
### 关于卡名
在指定一张卡时，您可以使用`八位密码`来指定。

当输入的卡名是汉字时，系统会从卡池中检索具有该名称的卡，有多个卡时，`八位密码`在先者优先：

    ! 31444249 >= 3      # 炼狱的虚梦
    ! 狱火机·提耶拉 >= 1   # 狱火机·提耶拉
    ! 陀螺 >= 3           # 疾行机人 贝陀螺集合体
    ! 天帝 >= 2           # 天帝从骑 爱迪娅
    ! 真六武众 紫炎 >= 1   # 没有合适的卡匹配

## 怎样定义一个卡组
第一行如下：
    
    deck: 卡组名
    
还可在定义卡组名时快捷指定卡组优先级：

    deck: 卡组名 [优先级]
    
然后在缩进下输入您的约束即可，如：

    deck: 炼装
        ! [炼装] >= 10
        ! 威风妖怪 麒麟 >= 2
        
当所有约束**均成立**时，则认为送入的卡组满足条件。

### 为卡组定义优先级

    deck: Sample1
        priority: 10
        
有多个优先级定义时，**最后**那个生效。

### 为卡组定义标签（Tag）
在卡组中定义的标签 **仅属于这个卡组类型**。

为卡组定义标签时，直接缩进一级编写即可。

若不为标签编写内容，则在所有文件载入结束以后，程序会从所有标签池中搜索符合名称的第一个标签代入。

此外，你可以用字段 `check tag` `force tag` `force` `refuse tag` `refuse` 来指定标签的特别功能。其作用请参见文末的字段一览表。

##怎样定义一个标签（Tag）

第一行如下：

    tag: 标签名 [优先级]
    
同样优先级是可选项。不需要优先级的场合，还可以用下列方式快捷定义：

    (标签名)
    
请注意括号为半角括号。

此后用同样的方式编写约束即可：

    (吸毒壶)
        ! 强欲而贪欲之壶 >= 2
        
如果需要制定特别的参数（如 `global`，`upgrade`），需用 `config:` 行指定：

    (十二兽)
        config: global
        config: upgrade
        ! [十二兽] >= 7
        
# 自定义字段 `*`
对于像 `青色眼睛的` 这样并无显式字段，但需要使用的场合，直接当做这是一个字段书写即可：

        restrain: [青色眼睛的] >= 3
        
程序会到数据库中搜索具有该名称的卡并当做一个字段来看待。

对于像 `大宇宙` 和 `次元的裂缝` 这样的有明显功能分类又不具有相同字段者，您可以用 `set` 和 `set card` 两关键字自定义字段：
    
    # set 必须顶格书写，以与约束条件中的 set 区分
    set: 友情的见证之次元场地 # 请长远考虑 Konami 会不会出撞名的字段
        set card: 大宇宙
        set card: 次元的裂缝
        假面英雄 暗爪 # 你可以不写 set card 前缀。该特性可能不稳定。
        
你也可以用 `inner set` 定义嵌套字段，定义时该字段必须已经存在：
    
    [猫头鹰爱你哦] # 可以顶格直接这样写，特性不稳定
        inner set: 黑羽
        [急袭猛禽] # 简写形式
        血风燕

# 组合逻辑 `**`
对于逻辑判断中需要使用 `and` 和 `or` 的情形，可以用 `restrains` 字段约束：
    
    restrains: or
        ! 内置式机枪 >= 3
        ! 内置式爆弹 >= 3
        
**提醒**：请不要忘记 `s`。        
        
`restrains` 后可以书写的内容包括：`and` 或者 `or` 分别对应 `且` 和 `或`。

你可以用 `and` 和 `or` 字段来简写：

    and:
        or:
            ! [炼装] > 5
            ! [魔术师] > 6
        ! [神数] >= 3
        
从外你可以对 `restrains` 后面的内容用条件来约束：

    restrains: >= 2
        ! [异色眼] > 0
        ! [娱乐伙伴] > 0
        ! [魔术师] > 0
        ! [娱乐法师] > 0
        ! [炼装] > 0
        
每个下设条目会被赋权为 `1`。
# 范例
范例可以参考本仓库内的 `set.deckdef` 和 `xpg.deckdef` 文件。

# 字段一览表
注：每个字段后的冒号已经省略。

冒号在书写时确可省略，但请勿过分依赖此功能。

字段|等价写法|功能|备注|
:---:|:---:|---|---
`deck`|顶格书写|定义一个卡组类别
`tag`|顶格`(name)`|定义一个标签
`classification`|无|定义一个卡组类别或标签|是何者由有无括号决定
`check tag`|`tag`|此卡组类别检查该标签|`(name)` 亦可
`refuse tag`|`refuse`|此卡组类别不可与该标签共存
`force tag`|`force`|此卡组类别自带该标签
`card`|无|约束某张卡的数量
`set`|`series`|约束某字段卡的数量
`restrain`|`!`|约束某些卡的数量|是何者由有无方括号决定
`and`|`&` `&&`|定义一个`与`类型约束组
`or`|同上|定义一个`或`类型约束组
`restrains`|无|定义一个约束组|是何类型由参数决定
`priority`|`[priority]`|定义优先级
`config`|无|定义标签的参数
`set`|顶格`[name]`|定义自定义字段|必须顶格
`set card`|直接书写|定义自定义字段中的卡片
`inner set`|`[name]`|定义自定义字段中的内嵌字段|必须是已存在的字段

# Config 一览表

配置名|功能
:---:|---
`global`| 指出此标签是全局的。
`upgrade`| **升级**机制有效。自带 `global`。
`* prefix`| 将此标签作为一个前缀加到卡组名中。
`* appendix`| 将此标签作为一个后缀加到卡组名中。
# 附注
`*` 该功能尚在商讨中。

`**` 该功能不稳定并在测试中。
